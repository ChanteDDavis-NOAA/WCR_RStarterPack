---
title: "About our community"
---

## Where are we?

```{r, include=FALSE}
library(dplyr)
library(leaflet)
```

```{r, include=FALSE}
members <- googlesheets::gs_read(
  googlesheets::gs_key(
    "1WyfmLfoAQUP2iRogqcOfYA9Hum7DT0BcVyTtei_6Xjw", 
    lookup = TRUE, visibility = "private"
  )
) %>% 
  tidyr::unite_(col = "Name", from = c("First name", "Last name"),
                sep = " ", remove = TRUE) %>%
  mutate(Name = if_else(is.na(Website), Name, 
                        paste0("<a href='", Website, "' target='_blank'>", Name, "</a>")))

members$Status[is.na(members$Status)] <- "member"
stopifnot(all(members$Status %in% c("member", "referent", "admin")))

members2 <- subset(members, select = -Website) %>% 
  mutate(
    infos = paste0(
      Name, "<br>",
      if_else(is.na(Institution), "", paste0("at ", Institution, "<br>")),
      if_else(is.na(Field), "", paste0("in ", Field, "<br>")),
      if_else(is.na(Keywords), "", paste0("knows ", Keywords))
    )
  )
```

```{r, echo=FALSE, message=FALSE}
suppressWarnings(
  leaflet(members2, width = "100%") %>% 
    setView(lng = 5.767249, lat = 45.190590, zoom = 12) %>% 
    addTiles(options = providerTileOptions(minZoom = 2, maxZoom = 20)) %>%
    addAwesomeMarkers(lng = 5.767249, lat = 45.190590, 
                      popup = "Meeting location",
                      label = "Meeting location",
                      icon = makeAwesomeIcon("android-locate", library = "ion", markerColor = "red")) %>%
    addAwesomeMarkers(popup = ~infos,
                      label = ~lapply(infos, htmltools::HTML),
                      clusterOptions = markerClusterOptions(),
                      icon = makeAwesomeIcon("person", library = "ion", markerColor = ~if_else(Status == "member", "blue", "darkblue"))) %>%
    htmlwidgets::onRender('
      function(el, x) {
        var myMap = this;
        myMap.on("click", function(e) {
          alert("Latitude: " + e.latlng.lat + "\\nLongitude: " + e.latlng.lng)
        })
      }')
)
```

```{r, echo=FALSE}
DT::datatable(select(members2, -c(Latitude, Longitude, infos)), 
              rownames = FALSE, escape = FALSE)
```


**Status:**

- 'admin' refers to administrators of the website and the mailing list,
- 'referent' refers to dedicated contact persons within institutions,
- 'member' refers to all other members of the community.

<br>

### How to be added?

Please fill the [google doc](https://docs.google.com/spreadsheets/d/1qdG7PPlRCAU8L6Hhq1D2zT0q9LWDUzBfq7mIzz_6Dm8/edit?usp=sharing) (**follow the guidelines!!**) and wait for an admin to upload your data to the actual list of members.